<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MSN Messenger 2004</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Tahoma", "Arial", sans-serif;
        }

        body {
            background: #0066cc;
            height: 100vh;
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
        }

        .msn-container {
            width: 95%;
            height: 95%;
            background-color: rgba(236, 233, 216, 0.95);
            border: 2px solid #003399;
            border-radius: 5px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .title-bar {
            background: linear-gradient(to right, #0a246a, #a6caf0);
            color: white;
            padding: 5px 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 12px;
            font-weight: bold;
            border-bottom: 1px solid #003399;
        }

        .window-controls {
            display: flex;
        }

        .control-btn {
            width: 18px;
            height: 18px;
            margin-left: 5px;
            background-color: #ece9d8;
            border: 1px solid #003399;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 10px;
            font-weight: bold;
            cursor: pointer;
        }

        .control-btn:hover {
            background-color: #d4d0c8;
        }

        .menu-bar {
            background-color: #ece9d8;
            border-bottom: 1px solid #aca899;
            padding: 3px 5px;
            display: flex;
            font-size: 11px;
        }

        .menu-item {
            margin-right: 15px;
            cursor: pointer;
        }

        .menu-item:hover {
            text-decoration: underline;
        }

        .toolbar {
            background-color: #ece9d8;
            border-bottom: 1px solid #aca899;
            padding: 5px 10px;
            display: flex;
            font-size: 11px;
            flex-wrap: wrap;
        }

        .tool-btn {
            margin-right: 10px;
            cursor: pointer;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .tool-btn:hover {
            background-color: #d4d0c8;
        }

        .recipient-bar {
            background-color: #ece9d8;
            border-bottom: 1px solid #aca899;
            padding: 5px 10px;
            font-size: 11px;
            display: flex;
            align-items: center;
        }

        .recipient-label {
            margin-right: 5px;
        }

        .voice-clip {
            display: flex;
            align-items: center;
            margin-left: 20px;
            font-size: 11px;
        }

        .checkboxes {
            display: flex;
            margin-left: 20px;
        }

        .checkbox {
            width: 15px;
            height: 15px;
            border: 1px solid #003399;
            margin-right: 5px;
            background-color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 10px;
        }

        .checkbox.checked {
            background-color: #0066cc;
            color: white;
        }

        .action-buttons {
            display: flex;
            margin-left: auto;
        }

        .action-btn {
            background: linear-gradient(to bottom, #f0f0f0, #d4d0c8);
            border: 1px solid #aca899;
            padding: 4px 10px;
            margin-left: 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 11px;
        }

        .action-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #c4c0b8);
        }

        .footer {
            background-color: #ece9d8;
            border-top: 1px solid #aca899;
            padding: 5px 10px;
            font-size: 10px;
            color: #666;
            text-align: center;
        }

        .main-content {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        .contacts-panel {
            width: 200px;
            background-color: #ece9d8;
            border-right: 1px solid #aca899;
            padding: 10px;
            overflow-y: auto;
        }

        .contact-group {
            margin-bottom: 15px;
        }

        .group-title {
            font-weight: bold;
            font-size: 11px;
            color: #003399;
            margin-bottom: 5px;
            cursor: pointer;
        }

        .contact {
            padding: 5px;
            font-size: 11px;
            display: flex;
            align-items: center;
            cursor: pointer;
            border-radius: 3px;
        }

        .contact:hover {
            background-color: #d4d0c8;
        }

        .status-icon {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .online {
            background-color: #00cc00;
        }

        .away {
            background-color: #ffcc00;
        }

        .busy {
            background-color: #ff0000;
        }

        .chat-area {
            flex: 1;
            display: flex;
            flex-direction: column;
            background-color: white;
        }

        .chat-header {
            background: linear-gradient(to right, #0a246a, #a6caf0);
            color: white;
            padding: 5px 10px;
            font-size: 12px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-messages {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            background-color: white;
            border-bottom: 1px solid #aca899;
        }

        .message {
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 5px;
            max-width: 80%;
        }

        .received {
            background-color: #f0f0f0;
            align-self: flex-start;
        }

        .sent {
            background-color: #e1f5fe;
            align-self: flex-end;
            margin-left: auto;
        }

        .message-sender {
            font-weight: bold;
            font-size: 11px;
        }

        .message-time {
            font-size: 9px;
            color: #666;
            margin-left: 5px;
        }

        .message-text {
            font-size: 12px;
            margin-top: 3px;
        }

        .chat-input {
            display: flex;
            padding: 10px;
            background-color: #ece9d8;
        }

        .input-field {
            flex: 1;
            padding: 8px;
            border: 1px solid #aca899;
            border-radius: 3px;
            font-size: 12px;
        }

        .send-btn {
            background: linear-gradient(to bottom, #f0f0f0, #d4d0c8);
            border: 1px solid #aca899;
            padding: 8px 15px;
            margin-left: 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .send-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #c4c0b8);
        }

        .wizz-btn {
            background: linear-gradient(to bottom, #ff9900, #ff6600);
            border: 1px solid #cc6600;
            padding: 8px 15px;
            margin-left: 10px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            color: white;
            font-weight: bold;
        }

        .wizz-btn:hover {
            background: linear-gradient(to bottom, #ff8800, #ff5500);
        }

        .emoticons-bar {
            background-color: #ece9d8;
            padding: 5px 10px;
            display: flex;
            border-top: 1px solid #aca899;
        }

        .emoticon {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 14px;
        }

        .emoticon:hover {
            background-color: #d4d0c8;
            border-radius: 3px;
        }

        /* Page d'administration cachée */
        .admin-panel {
            position: fixed;
            top: 0;
            right: -400px;
            width: 400px;
            height: 100vh;
            background-color: #ece9d8;
            border-left: 2px solid #003399;
            transition: right 0.3s ease;
            z-index: 1000;
            display: flex;
            flex-direction: column;
        }

        .admin-panel.open {
            right: 0;
        }

        .admin-header {
            background: linear-gradient(to right, #0a246a, #a6caf0);
            color: white;
            padding: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .admin-content {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
        }

        .admin-section {
            margin-bottom: 20px;
            border: 1px solid #aca899;
            padding: 10px;
            border-radius: 5px;
            background-color: white;
        }

        .admin-section h3 {
            color: #003399;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .admin-btn {
            background: linear-gradient(to bottom, #f0f0f0, #d4d0c8);
            border: 1px solid #aca899;
            padding: 8px 15px;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
            margin-right: 10px;
            margin-bottom: 10px;
        }

        .admin-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #c4c0b8);
        }

        .admin-input {
            width: 100%;
            padding: 8px;
            border: 1px solid #aca899;
            border-radius: 3px;
            margin-bottom: 10px;
            font-size: 12px;
        }

        .admin-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #003399;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            font-size: 20px;
            z-index: 999;
            display: none;
        }

        /* Formulaire d'inscription */
        .login-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }

        .login-form {
            width: 300px;
            background-color: #ece9d8;
            border: 2px solid #003399;
            border-radius: 5px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .login-header {
            background: linear-gradient(to right, #0a246a, #a6caf0);
            color: white;
            padding: 10px;
            text-align: center;
            margin-bottom: 15px;
            font-weight: bold;
        }

        .login-input {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #aca899;
            border-radius: 3px;
            font-size: 12px;
        }

        .color-picker {
            display: flex;
            margin-bottom: 10px;
        }

        .color-option {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border: 1px solid #333;
            cursor: pointer;
        }

        .login-btn {
            width: 100%;
            padding: 8px;
            background: linear-gradient(to bottom, #f0f0f0, #d4d0c8);
            border: 1px solid #aca899;
            border-radius: 3px;
            cursor: pointer;
            font-size: 12px;
        }

        .login-btn:hover {
            background: linear-gradient(to bottom, #e0e0e0, #c4c0b8);
        }

        /* Animation Wizz */
        @keyframes wizz {
            0% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            50% { transform: translateX(10px); }
            75% { transform: translateX(-10px); }
            100% { transform: translateX(0); }
        }

        .wizz-active {
            animation: wizz 0.2s linear 5;
        }

        .admin-badge {
            background-color: #ff6600;
            color: white;
            padding: 2px 5px;
            border-radius: 3px;
            font-size: 9px;
            margin-left: 5px;
        }
    </style>
</head>
<body>
    <!-- Formulaire de connexion -->
    <div class="login-container" id="loginContainer">
        <div class="login-form">
            <div class="login-header">MSN Messenger 2004 - Connexion</div>
            <input type="text" class="login-input" id="usernameInput" placeholder="Nom d'utilisateur">
            <input type="password" class="login-input" id="passwordInput" placeholder="Mot de passe">
            <div class="color-picker">
                <div class="color-option" style="background-color: #000000;" data-color="#000000"></div>
                <div class="color-option" style="background-color: #ff0000;" data-color="#ff0000"></div>
                <div class="color-option" style="background-color: #0000ff;" data-color="#0000ff"></div>
                <div class="color-option" style="background-color: #008000;" data-color="#008000"></div>
                <div class="color-option" style="background-color: #800080;" data-color="#800080"></div>
            </div>
            <button class="login-btn" id="loginBtn">Se connecter</button>
            <div style="font-size: 10px; text-align: center; margin-top: 10px; color: #666;">
                Admin: admin / msn2004
            </div>
        </div>
    </div>

    <!-- Interface MSN Messenger -->
    <div class="msn-container" id="msnContainer" style="display: none;">
        <!-- Barre de titre -->
        <div class="title-bar">
            <div>MSN Messenger 2004 <span id="adminBadge" class="admin-badge" style="display: none;">ADMIN</span></div>
            <div class="window-controls">
                <div class="control-btn">_</div>
                <div class="control-btn">□</div>
                <div class="control-btn" id="closeBtn">×</div>
            </div>
        </div>

        <!-- Barre de menu -->
        <div class="menu-bar">
            <div class="menu-item">File</div>
            <div class="menu-item">Edit</div>
            <div class="menu-item">Actions</div>
            <div class="menu-item">Tools</div>
            <div class="menu-item">Help</div>
        </div>

        <!-- Barre d'outils -->
        <div class="toolbar">
            <div class="tool-btn">Invite</div>
            <div class="tool-btn">Send Files</div>
            <div class="tool-btn">Video</div>
            <div class="tool-btn">Voice</div>
            <div class="tool-btn">Activities</div>
            <div class="tool-btn">Games</div>
        </div>

        <!-- Barre de destinataire -->
        <div class="recipient-bar">
            <div class="recipient-label">To:</div>
            <div>All Hail The Heartbreaker &lt;/3 &lt;glitter_gak@ho&gt;</div>
            <div class="voice-clip">
                <div class="checkbox"></div>
                <div>Voice Clip</div>
            </div>
            <div class="checkboxes">
                <div class="checkbox checked">x</div>
                <div class="checkbox checked">x</div>
                <div class="checkbox checked">x</div>
                <div class="checkbox checked">x</div>
                <div class="checkbox checked">x</div>
            </div>
            <div class="action-buttons">
                <div class="action-btn">Send</div>
                <div class="action-btn">Search</div>
            </div>
        </div>

        <!-- Contenu principal -->
        <div class="main-content">
            <!-- Panneau des contacts -->
            <div class="contacts-panel">
                <div class="contact-group">
                    <div class="group-title">En ligne (3)</div>
                    <div class="contact">
                        <div class="status-icon online"></div>
                        <div>Marie Dupont</div>
                    </div>
                    <div class="contact">
                        <div class="status-icon online"></div>
                        <div>Jean Martin</div>
                    </div>
                    <div class="contact">
                        <div class="status-icon away"></div>
                        <div>Sophie Leroy</div>
                    </div>
                </div>
                <div class="contact-group">
                    <div class="group-title">Hors ligne (2)</div>
                    <div class="contact">
                        <div class="status-icon busy"></div>
                        <div>Thomas Bernard</div>
                    </div>
                    <div class="contact">
                        <div class="status-icon busy"></div>
                        <div>Laura Petit</div>
                    </div>
                </div>
            </div>

            <!-- Zone de chat -->
            <div class="chat-area">
                <div class="chat-header">
                    <div>Conversation avec Marie Dupont</div>
                    <div class="window-controls">
                        <div class="control-btn">_</div>
                        <div class="control-btn">×</div>
                    </div>
                </div>
                <div class="chat-messages" id="chatMessages">
                    <div class="message received">
                        <div class="message-sender">Marie Dupont <span class="message-time">14:30</span></div>
                        <div class="message-text">Salut ! Comment ça va ?</div>
                    </div>
                    <div class="message sent">
                        <div class="message-sender">Moi <span class="message-time">14:31</span></div>
                        <div class="message-text">Ça va bien, merci ! Et toi ?</div>
                    </div>
                    <div class="message received">
                        <div class="message-sender">Marie Dupont <span class="message-time">14:32</span></div>
                        <div class="message-text">Très bien aussi ! Tu as vu le nouveau film ?</div>
                    </div>
                </div>
                <div class="emoticons-bar">
                    <div class="emoticon">:)</div>
                    <div class="emoticon">:(</div>
                    <div class="emoticon">:D</div>
                    <div class="emoticon">;)</div>
                    <div class="emoticon">:P</div>
                    <div class="emoticon">:O</div>
                </div>
                <div class="chat-input">
                    <input type="text" class="input-field" id="messageInput" placeholder="Tapez votre message ici...">
                    <button class="send-btn" id="sendBtn">Envoyer</button>
                    <button class="wizz-btn" id="wizzBtn">Wizz!</button>
                </div>
            </div>
        </div>

        <!-- Pied de page -->
        <div class="footer">
            Click for new Emoticons and Theme Packs from Blue Mountain
        </div>
    </div>

    <!-- Panneau d'administration caché -->
    <div class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <div>Administration - Panel de Contrôle</div>
            <div class="control-btn" id="closeAdmin">×</div>
        </div>
        <div class="admin-content">
            <div class="admin-section">
                <h3>Gestion des utilisateurs</h3>
                <div id="usersList">
                    <p>Chargement des utilisateurs...</p>
                </div>
                <button class="admin-btn" onclick="refreshUsers()">Actualiser</button>
                <button class="admin-btn" onclick="banUser()">Bannir utilisateur</button>
                <button class="admin-btn" onclick="changeAdminPassword()">Changer mot de passe admin</button>
            </div>
            <div class="admin-section">
                <h3>Gestion des messages</h3>
                <button class="admin-btn" onclick="viewAllMessages()">Voir tous les messages</button>
                <button class="admin-btn" onclick="clearChat()">Effacer le chat</button>
                <button class="admin-btn" onclick="exportLogs()">Exporter les logs</button>
            </div>
            <div class="admin-section">
                <h3>Paramètres du chat</h3>
                <input type="text" class="admin-input" id="chatName" placeholder="Nom du chat">
                <input type="text" class="admin-input" id="chatDescription" placeholder="Description">
                <button class="admin-btn" onclick="saveSettings()">Sauvegarder</button>
            </div>
            <div class="admin-section">
                <h3>Statistiques</h3>
                <p id="statsOnline">Utilisateurs en ligne: 0</p>
                <p id="statsMessages">Messages aujourd'hui: 0</p>
                <p id="statsNewUsers">Nouveaux utilisateurs: 0</p>
                <button class="admin-btn" onclick="updateStats()">Actualiser stats</button>
            </div>
            <div class="admin-section">
                <h3>Actions administrateur</h3>
                <button class="admin-btn" style="background: #ff6666; color: white;" onclick="adminBroadcast()">Message global</button>
                <button class="admin-btn" style="background: #ff6666; color: white;" onclick="systemRestart()">Redémarrer système</button>
            </div>
        </div>
    </div>

    <!-- Bouton pour ouvrir l'administration -->
    <div class="admin-toggle" id="adminToggle">⚙</div>

    <script>
        // Variables globales
        let currentUser = null;
        let userColor = '#000000';
        let audioContext = null;
        let isAdmin = false;

        // Identifiants administrateur - MODIFIABLES
        let ADMIN_CREDENTIALS = {
            username: "admin",
            password: "msn2004"
        };

        // Stockage des données
        let chatUsers = [];
        let chatMessages = [];
        let chatSettings = {
            name: "MSN Messenger 2004 Chat",
            description: "Chat rétro style MSN Messenger"
        };

        // Initialisation
        document.addEventListener('DOMContentLoaded', function() {
            // Charger les données sauvegardées
            loadSavedData();
            
            // Gestion de la connexion
            document.getElementById('loginBtn').addEventListener('click', login);
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    login();
                }
            });

            // Gestion des couleurs
            document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', function() {
                    userColor = this.getAttribute('data-color');
                    document.querySelectorAll('.color-option').forEach(opt => {
                        opt.style.border = '1px solid #333';
                    });
                    this.style.border = '2px solid #0066cc';
                });
            });

            // Gestion de l'envoi de messages
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('messageInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Gestion du Wizz
            document.getElementById('wizzBtn').addEventListener('click', sendWizz);

            // Gestion de l'administration
            document.getElementById('adminToggle').addEventListener('click', function() {
                document.getElementById('adminPanel').classList.add('open');
                updateAdminPanel();
            });

            document.getElementById('closeAdmin').addEventListener('click', function() {
                document.getElementById('adminPanel').classList.remove('open');
            });

            // Gestion de la fermeture
            document.getElementById('closeBtn').addEventListener('click', function() {
                document.getElementById('msnContainer').style.display = 'none';
                document.getElementById('loginContainer').style.display = 'flex';
                currentUser = null;
                isAdmin = false;
                document.getElementById('adminToggle').style.display = 'none';
                document.getElementById('adminBadge').style.display = 'none';
            });
        });

        // FONCTION DE CONNEXION SÉCURISÉE
        function login() {
    // CHARGER LE MOT DE PASSE ACTUALISÉ
    loadSavedData();
    
    const username = document.getElementById('usernameInput').value.trim();
            
            if (username && password) {
                // LISTE DES PSEUDOS ADMIN INTERDITS
                const adminVariants = ['admin', 'administrateur', 'administrator', 'moderateur', 'modo', 'root', 'superuser', 'sysadmin'];
                const isAdminVariant = adminVariants.some(variant => 
                    username.toLowerCase().includes(variant.toLowerCase())
                );
                
                // BLOQUER les pseudos admin sans le bon mot de passe
                if (isAdminVariant && !(username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password)) {
                    alert('❌ Accès refusé : Ce pseudo est réservé aux administrateurs');
                    return;
                }
                
                // Vérifier si c'est le VRAI admin
                if (username === ADMIN_CREDENTIALS.username && password === ADMIN_CREDENTIALS.password) {
                    isAdmin = true;
                    currentUser = "Administrateur";
                    document.getElementById('adminToggle').style.display = 'flex';
                    document.getElementById('adminBadge').style.display = 'inline';
                } else {
                    isAdmin = false;
                    currentUser = username;
                    document.getElementById('adminToggle').style.display = 'none';
                    document.getElementById('adminBadge').style.display = 'none';
                    
                    // Enregistrer l'utilisateur normal
                    if (!chatUsers.find(u => u.username === username)) {
                        chatUsers.push({
                            username: username,
                            color: userColor,
                            joinDate: new Date(),
                            isBanned: false
                        });
                        saveData();
                    }
                }
                
                document.getElementById('loginContainer').style.display = 'none';
                document.getElementById('msnContainer').style.display = 'flex';
                
                // Ajouter un message de bienvenue
                const messagesContainer = document.getElementById('chatMessages');
                const now = new Date();
                const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                const welcomeElement = document.createElement('div');
                welcomeElement.className = 'message received';
                welcomeElement.innerHTML = `
                    <div class="message-sender">Système <span class="message-time">${timeString}</span></div>
                    <div class="message-text">Bienvenue ${currentUser} ! ${isAdmin ? 'Vous êtes connecté en tant qu\'administrateur.' : 'Vous êtes maintenant connecté.'}</div>
                `;
                
                messagesContainer.appendChild(welcomeElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            } else {
                alert('Veuillez entrer un nom d\'utilisateur et un mot de passe');
            }
        }

        function sendMessage() {
            if (!currentUser) return;
            
            const input = document.getElementById('messageInput');
            const message = input.value.trim();
            
            if (message) {
                const messagesContainer = document.getElementById('chatMessages');
                const now = new Date();
                const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                const messageElement = document.createElement('div');
                messageElement.className = 'message sent';
                messageElement.innerHTML = `
                    <div class="message-sender" style="color: ${isAdmin ? '#ff0000' : userColor};">${currentUser} ${isAdmin ? '<span style="color: #ff0000;">[ADMIN]</span>' : ''} <span class="message-time">${timeString}</span></div>
                    <div class="message-text" style="color: ${isAdmin ? '#ff0000' : userColor};">${message}</div>
                `;
                
                messagesContainer.appendChild(messageElement);
                
                // Sauvegarder le message
                chatMessages.push({
                    user: currentUser,
                    text: message,
                    time: new Date(),
                    isAdmin: isAdmin,
                    color: isAdmin ? '#ff0000' : userColor
                });
                saveData();
                
                input.value = '';
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                
                // Simuler une réponse après un délai
                setTimeout(() => {
                    const responses = [
                        "Intéressant !",
                        "Je vois ce que tu veux dire.",
                        "D'accord, je note.",
                        "C'est une bonne idée !",
                        "Je ne suis pas sûr de comprendre.",
                        "Haha, c'est drôle !",
                        "Vraiment ?",
                        "Continue, je t'écoute."
                    ];
                    const randomResponse = responses[Math.floor(Math.random() * responses.length)];
                    
                    const responseElement = document.createElement('div');
                    responseElement.className = 'message received';
                    responseElement.innerHTML = `
                        <div class="message-sender">Marie Dupont <span class="message-time">${now.getHours()}:${(now.getMinutes() + 1).toString().padStart(2, '0')}</span></div>
                        <div class="message-text">${randomResponse}</div>
                    `;
                    
                    messagesContainer.appendChild(responseElement);
                    messagesContainer.scrollTop = messagesContainer.scrollHeight;
                }, 1000 + Math.random() * 2000);
            }
        }

        function sendWizz() {
            if (!currentUser) return;
            
            // Animation de vibration
            document.getElementById('msnContainer').classList.add('wizz-active');
            
            // Son de vibration (simulé avec l'API Web Audio)
            playWizzSound();
            
            // Message de Wizz
            const messagesContainer = document.getElementById('chatMessages');
            const now = new Date();
            const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
            
            const wizzElement = document.createElement('div');
            wizzElement.className = 'message received';
            wizzElement.innerHTML = `
                <div class="message-sender">Système <span class="message-time">${timeString}</span></div>
                <div class="message-text" style="font-weight: bold; color: #ff6600;">${currentUser} a envoyé un Wizz !</div>
            `;
            
            messagesContainer.appendChild(wizzElement);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // Retirer l'animation après la fin
            setTimeout(() => {
                document.getElementById('msnContainer').classList.remove('wizz-active');
            }, 1000);
        }

        function playWizzSound() {
            try {
                if (!audioContext) {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                }
                
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(150, audioContext.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(50, audioContext.currentTime + 0.5);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                
                oscillator.start(audioContext.currentTime);
                oscillator.stop(audioContext.currentTime + 0.5);
            } catch (e) {
                console.log("L'API Audio n'est pas supportée");
            }
        }

        // FONCTIONS D'ADMINISTRATION
        function updateAdminPanel() {
            if (!isAdmin) return;
            
            // Mettre à jour la liste des utilisateurs
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '<h4>Utilisateurs enregistrés:</h4>';
            
            if (chatUsers.length === 0) {
                usersList.innerHTML += '<p>Aucun utilisateur enregistré</p>';
            } else {
                chatUsers.forEach(user => {
                    usersList.innerHTML += `
                        <div style="font-size: 11px; margin: 2px 0; padding: 2px; background: ${user.isBanned ? '#ffcccc' : '#f0f0f0'}; border-radius: 3px;">
                            ${user.username} - ${user.joinDate.toLocaleDateString()} ${user.isBanned ? '<span style="color: red;">[BANNI]</span>' : ''}
                        </div>
                    `;
                });
            }
            
            // Mettre à jour les statistiques
            updateStats();
            
            // Charger les paramètres
            document.getElementById('chatName').value = chatSettings.name;
            document.getElementById('chatDescription').value = chatSettings.description;
        }

        function refreshUsers() {
            if (!isAdmin) return;
            updateAdminPanel();
            alert('Liste des utilisateurs actualisée !');
        }

        function banUser() {
            if (!isAdmin) return;
            const username = prompt('Nom d\'utilisateur à bannir:');
            if (username) {
                const user = chatUsers.find(u => u.username === username);
                if (user) {
                    user.isBanned = !user.isBanned;
                    saveData();
                    updateAdminPanel();
                    alert(`Utilisateur ${username} ${user.isBanned ? 'banni' : 'débanni'} !`);
                } else {
                    alert('Utilisateur non trouvé !');
                }
            }
        }

        // NOUVELLE FONCTION : CHANGER MOT DE PASSE ADMIN
        function changeAdminPassword() {
    if (!isAdmin) return;
    
    // Créer une boîte de dialogue personnalisée avec astérisques
    const newPassword = prompt('Nouveau mot de passe admin:\n\n(Le mot de passe sera identique sur tous les appareils)');
    
    if (newPassword && newPassword.length >= 4) {
        // MOT DE PASSE FIXE - synchronisé sur tous les appareils
        ADMIN_CREDENTIALS.password = newPassword;
        
        // NE PLUS sauvegarder dans localStorage
        // localStorage.setItem('adminCredentials', JSON.stringify(ADMIN_CREDENTIALS));
        
        alert('✅ Mot de passe admin changé avec succès !\n\nNouveau mot de passe : ' + newPassword + '\n\nCe mot de passe sera valable sur tous les navigateurs et appareils.');
        
    } else if (newPassword) {
        alert('❌ Le mot de passe doit faire au moins 4 caractères');
    }
}

        function viewAllMessages() {
            if (!isAdmin) return;
            alert(`Total des messages: ${chatMessages.length}\nDernier message: ${chatMessages.length > 0 ? chatMessages[chatMessages.length-1].text : 'Aucun'}`);
        }

        function clearChat() {
            if (!isAdmin) return;
            if (confirm('Voulez-vous vraiment effacer tout l\'historique du chat ?')) {
                document.getElementById('chatMessages').innerHTML = '';
                chatMessages = [];
                saveData();
                alert('Chat effacé !');
            }
        }

        function exportLogs() {
            if (!isAdmin) return;
            const logs = chatMessages.map(msg => 
                `[${msg.time.toLocaleString()}] ${msg.user}: ${msg.text}`
            ).join('\n');
            
            const blob = new Blob([logs], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'chat_logs.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function saveSettings() {
            if (!isAdmin) return;
            chatSettings.name = document.getElementById('chatName').value;
            chatSettings.description = document.getElementById('chatDescription').value;
            saveData();
            alert('Paramètres sauvegardés !');
        }

        function updateStats() {
            if (!isAdmin) return;
            const today = new Date().toDateString();
            const todayMessages = chatMessages.filter(msg => 
                msg.time.toDateString() === today
            ).length;
            
            document.getElementById('statsOnline').textContent = `Utilisateurs en ligne: ${chatUsers.length}`;
            document.getElementById('statsMessages').textContent = `Messages aujourd'hui: ${todayMessages}`;
            document.getElementById('statsNewUsers').textContent = `Nouveaux utilisateurs: ${chatUsers.length}`;
        }

        function adminBroadcast() {
            if (!isAdmin) return;
            const message = prompt('Message global à envoyer:');
            if (message) {
                const messagesContainer = document.getElementById('chatMessages');
                const now = new Date();
                const timeString = `${now.getHours()}:${now.getMinutes().toString().padStart(2, '0')}`;
                
                const broadcastElement = document.createElement('div');
                broadcastElement.className = 'message received';
                broadcastElement.innerHTML = `
                    <div class="message-sender" style="color: #ff0000;">Système <span class="message-time">${timeString}</span></div>
                    <div class="message-text" style="color: #ff0000; font-weight: bold;">[ADMIN] ${message}</div>
                `;
                
                messagesContainer.appendChild(broadcastElement);
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
                alert('Message global envoyé !');
            }
        }

        function systemRestart() {
            if (!isAdmin) return;
            if (confirm('Redémarrer le système ? Cela effacera toutes les données.')) {
                localStorage.clear();
                chatUsers = [];
                chatMessages = [];
                alert('Système redémarré !');
                location.reload();
            }
        }

        // Sauvegarde des données
        function saveData() {
            const data = {
                users: chatUsers,
                messages: chatMessages,
                settings: chatSettings
            };
            localStorage.setItem('msnChatData', JSON.stringify(data));
        }

        function loadSavedData() {
            const saved = localStorage.getItem('msnChatData');
            const savedAdmin = localStorage.getItem('adminCredentials');
            
            if (saved) {
                const data = JSON.parse(saved);
                chatUsers = data.users || [];
                chatMessages = data.messages || [];
                chatSettings = data.settings || chatSettings;
            }
            
            // NE PLUS charger depuis localStorage - mot de passe fixe dans le code
// if (savedAdmin) {
//     ADMIN_CREDENTIALS = JSON.parse(savedAdmin);
// }
        // Gestion des émoticônes
        document.querySelectorAll('.emoticon').forEach(emoticon => {
            emoticon.addEventListener('click', function() {
                const input = document.getElementById('messageInput');
                input.value += this.textContent + ' ';
                input.focus();
            });
        });

        // Simulation de statuts de contact
        setInterval(() => {
            const contacts = document.querySelectorAll('.contact');
            const randomContact = contacts[Math.floor(Math.random() * contacts.length)];
            const statusIcon = randomContact.querySelector('.status-icon');
            
            const statuses = ['online', 'away', 'busy'];
            const currentStatus = statusIcon.className.split(' ')[1];
            let newStatus;
            
            do {
                newStatus = statuses[Math.floor(Math.random() * statuses.length)];
            } while (newStatus === currentStatus);
            
            statusIcon.className = 'status-icon ' + newStatus;
        }, 10000);
    </script>
</body>
</html>